<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.axiasoft.vote_back.admin.dao">
    <select id="selectLogin" parameterType="hashmap" resultType="hashmap">
        SELECT *
        FROM axia.admin
        WHERE ad_id = #{ad_id}
        AND ad_pw = #{ad_password}
    </select>

    <select id="selectLatestRound" resultType="int">
        SELECT round
        FROM axia.vote_round
        ORDER BY round DESC
        LIMIT 1
    </select>

    <select id="selectVoteResult" parameterType="hashmap" resultType="hashmap">
        SELECT a.vt_target,
               (select count(b.vt_target)
                from vote_result b
                where b.vt_target = a.vt_target
                  and b.vt_round = a.vt_round) as count
        FROM axia.vote_result a
        WHERE vt_round = 1
        order by vt_target;
    </select>
</mapper>